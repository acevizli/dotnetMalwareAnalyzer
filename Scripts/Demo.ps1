$basePath = $PSScriptRoot
if ([string]::IsNullOrEmpty($basePath))
{
    $basePath = Split-Path -parent $psISE.CurrentFile.Fullpath
}

$modulePath = $basePath + '\netstandard2.0\ICSharpCode.Decompiler.Powershell.dll'

Import-Module $modulePath
$version = Get-DecompilerVersion

# different test assemblies - it makes a difference wrt .deps.json so there are two netstandard tests here
$asm_netstdWithDepsJson = $args[0]

$decompiler = Get-Decompiler $asm_netstdWithDepsJson

$classes = Get-DecompiledTypes $decompiler -Types class
$classes.Count
$bracket = '@class@'
foreach ($c in $classes)
{
    Get-DecompiledSource $decompiler -TypeName $c.FullName
    Write-Output $bracket
}
