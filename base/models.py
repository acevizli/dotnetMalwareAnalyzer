from django.db import models

"""
class Malware(models.Model):
    id = models.AutoField(primary_key=True, editable=True)
    name = models.CharField(max_length=150, null=True, blank=True)


    def __str__(self):
        return self.name


class EntropySection(models.Model):
    malware = models.ForeignKey(Malware, on_delete=models.SET_NULL, null=True)
    name = models.CharField(max_length=200, null=True, blank=True)
    offset = models.IntegerField(null=True, blank=True)
    size = models.IntegerField(null=True, blank=True)
    id = models.AutoField(primary_key=True, editable=False)
    entropy = models.DecimalField(null=True, blank=True,max_digits=10,decimal_places=1)
    status = models.CharField(max_length=50, null=True, blank=True)
    def __str__(self):
        return str(self.malware.name)

class ClassCode(models.Model):
    malware = models.ForeignKey(Malware, on_delete=models.SET_NULL, null=True)
    code = models.TextField(null=True, blank=True)
    id = models.AutoField(primary_key=True, editable=False)
    def __str__(self):
        return str(self.malware.name)

"""


class Package(models.Model):
    package = models.CharField(max_length=100, null=True, blank=True)

    def __str__(self):
        return self.package


class ClassCode(models.Model):
    class MalwareType(models.TextChoices):
        KEYLOGGER = "keylogger"
        ENCRYPT = "encrypt"
        PERSISTENCE = "persistence"
        RECON = "reconnaissance"
        DEFAULT = "default"

    malware = models.CharField(max_length=50, null=True, blank=True)
    type = models.CharField(
        max_length=30,
        choices=MalwareType.choices,
        default=MalwareType.DEFAULT,
    )
    code = models.TextField(null=True, blank=True)
    MainCaller = models.TextField(null=True, blank=True)
    packageDependincies = models.ManyToManyField(Package, blank=True, editable=True)
    id = models.AutoField(primary_key=True, editable=False)

    def __str__(self):
        return self.malware
