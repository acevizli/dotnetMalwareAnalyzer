import React, { useEffect, useState } from "react";
import { Card, Row, Button, Col } from "react-bootstrap";
import { useCartContext } from "../context/cartContext";
function ModuleCard({ module }) {
  const versionList = module.dotnetVersions;
  const [added, setAdded] = useState(false);
  const { cart, addToCart, removeItem } = useCartContext();

  useEffect(() => {
    const tempItem = cart.find((i) => i.id === module.id);
    if (tempItem) {
      setAdded(true);
    } else {
      setAdded(false);
    }
  }, [added, cart]);
  const addAction = () => {
    addToCart(module);
    setAdded(true);
  };
  const removeAction = () => {
    removeItem(module.id);
    setAdded(false);
  };
  return (
    <Card className="my-3 rounded" style={{ width: "35rem", height: "28rem" }}>
      <Card.Header>
        <h3>{module.name}</h3>
      </Card.Header>
      <Card.Body>
        <Col>
          <Row>
            <h5>Type: {module.type}</h5>
          </Row>
          <Row>
            <h5>Description</h5>
          </Row>
          <Row>
            <p>{module.description}</p>
          </Row>

          <Row>
            <h5>Dotnet Versions</h5>
          </Row>
          {versionList.map((version) => (
            <Row>
              <p>{version.name}</p>
            </Row>
          ))}
        </Col>
      </Card.Body>
      <Card.Footer>
        {added ? (
          <Button variant="danger" onClick={removeAction}>
            Remove
          </Button>
        ) : (
          <Button onClick={addAction}>Add to Malware</Button>
        )}
      </Card.Footer>
    </Card>
  );
}

export default ModuleCard;
