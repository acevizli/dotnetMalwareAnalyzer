from rest_framework import serializers
from .models import ClassCode,VictimMachines, Reference,VictimMachines,DotnetVersion,Package

class ClassCodeSerializer(serializers.ModelSerializer):
    dotnetVersions = serializers.SerializerMethodField(read_only=True)
    name = serializers.SerializerMethodField(read_only=True)
    class Meta:
        model = ClassCode
        fields = [
            'id',
            'name',
            "type",
            "dotnetVersions",
            "description",
            "order"
        ]
    
    def get_dotnetVersions(self,object):
        dotnetVersions = object.dotnetVersion
        serializer = DotnetVersionSerializer(dotnetVersions,many = True)
        return serializer.data
    def get_name(self,object):
        return object.malware

class DotnetVersionSerializer(serializers.ModelSerializer):
    class Meta:
        model = DotnetVersion
        fields = ["name","dotnetVersion"]