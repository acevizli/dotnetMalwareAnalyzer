import os
import sys
import subprocess
folder = sys.argv[1]

dotnets = []
files = [f for f in os.listdir(folder) if f.endswith('.exe')]
print("------------------------------------------------------------------")
for file in files:
    stream = os.popen("diec.exe -d {}".format(folder +"\\"+ file))
    output = stream.readlines()
    for o in output:
        if "library: .NET" in o:
            dotnets.append(file)
            
for dotnet in dotnets:
    cleaned_code = os.popen("de4dot.exe {}".format(folder+"\\"+dotnet))
    output = cleaned_code.readlines()

