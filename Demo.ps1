$modulePath = 'C:\Users\IEUser\Desktop\ILSpy\ICSharpCode.Decompiler.PowerShell\bin\Debug\netstandard2.0\ICSharpCode.Decompiler.Powershell.dll'

Import-Module $modulePath
$version = Get-DecompilerVersion
Write-Output $version

# different test assemblies - it makes a difference wrt .deps.json so there are two netstandard tests here
$asm_netstdWithDepsJson = $args[0]

$decompiler = Get-Decompiler $asm_netstdWithDepsJson

$classes = Get-DecompiledTypes $decompiler -Types class
$classes.Count

foreach ($c in $classes)
{
    Get-DecompiledSource $decompiler -TypeName $c.FullName
}


